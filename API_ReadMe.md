# API 说明文档
-----------------------------------------------------------------------------------------------------
## 请求API说明

* URL: https://bi.arvatobi.com/mgm/open?name=g$mgm_user_qualify&ps={openid:""}
* POST请求
* 默认参数 
    * name: 接口名称
    * ps: 接口所需的参数json数据
* 返回结果结构：{"code":"0","message":"OK","data":"结果值JSON"}

-----------------------------------------------------------------------------------------------------

## 接口列表

### 1、活动参与资格判定接口 --H5活动入口 Step 1 资格判定接口

#### 接口名

g$mgm_user_qualify

#### 参数

* openid: 必须，传空即可，后台从cookie里获取

#### 返回值

##### 示例

```
    {"code":"0","message":"OK","data":"[{\"qualify\":\"exist\"}]"}
``` 

##### 值说明

* new:新客
* exist:老客
* none:不符合参与资格
-----------------------------------------------------------------------------------------------------

### 2、礼物领取状态接口 --H5活动入口 Step 2 礼品领取状态接口
#### 20180905变更-新增返回值cardcode （wx.openCard需要）
#### 接口名

g$mgm_offer_status

#### 参数

* openid: 必须，传空即可，后台从cookie里获取

#### 返回值

##### 示例

```
    {"code":"0","message":"OK","data":"[{\"offerid\":1,\"offername\":\"优雅回柜礼\",\"offerstatus\":1,\"bagid\":0},{\"offerid\":2,\"offername\":\"尊享买赠礼\",\"offerstatus\":1,\"bagid\":0},{\"offerid\":3,\"offername\":\"赠友礼遇\",\"offerstatus\":1,\"bagid\":1}]"}
	{"code":"0","message":"OK","data":"[{\"offerid\":4,\"offername\":\"新客香遇礼遇\",\"offerstatus\":1,\"bagid\":0}]"}
``` 

##### 值说明
offerstatus
* 1:未领取/已制作
* 2:已领取
* 3:已兑换
* 4:已过期

* bagid
    * 0:未制作
    * 1:性格标签，见下表id
    
        |id|name|
        |:---:|:---:|
        |1|黑暗骑士|
        |2|气场女王|
        |3|阳光宅男|
        |4|空灵少女|
        |5|摩登达人|
        |6|俏皮萝莉|
        |7|职场巨匠|

cardcode wx.openCard需要

-----------------------------------------------------------------------------------------------------

### 3、非锦囊类礼品领取接口 --H5活动入口 Step 3 礼品领取接口

#### 接口名

i$mgm_offer_apply

#### 参数

* openid: 必须，传空即可，后台从cookie里获取
* offerid: 必须，领取的礼物类型，见下表id
    
    |id|custype|offername|
    |:---:|:---:|:---:|
    |1|exists|优雅回柜礼|
    |2|exists|尊享买赠礼|
    |3|exists|赠友礼遇|
    |4|new|新客香遇礼遇|
	|5|new|锦囊游戏|

#### 返回值

##### 示例

```
	{"code":"0","message":"OK","data":"[{\"applyid\":1,\"errmsg\":\"success\"}]"}
``` 

##### 值说明

* applyid:0表示领取失败，其余表示领取编号
-----------------------------------------------------------------------------------------------------

### 4、老客制作锦囊接口 --H5活动入口 Step 4 制作锦囊

#### 接口名

i$mgm_bag_make

#### 参数

* openid: 必须，传空即可，后台从cookie里获取
* bagid: 必须，性格标签，见下表id
		id	name
		1	黑暗骑士
		2	气场女王
		3	阳光宅男
		4	空灵少女
		5	摩登达人
		6	俏皮萝莉
		7	职场巨匠

#### 返回值

##### 示例

```
	{"code":"0","message":"OK","data":"[{\"succ\":1}]"}
``` 

##### 值说明

* succ:0表示制作失败，1制作成功
-----------------------------------------------------------------------------------------------------

### 5、微信是否关注 

#### 接口名

user_follow

##### 参数

* openid: 必须，领取人微信号，传空即可，后台从cookie里获取

#### 返回值

##### 示例

```
	{"code":"0","message":"OK","data":"1"}
``` 

##### 值说明

* data:0表示未关注，1表示已关注
-----------------------------------------------------------------------------------------------------

### 6、微信是否绑定 

#### 接口名

user_bind

##### 参数

* openid: 必须，领取人微信号，传空即可，后台从cookie里获取

#### 返回值

##### 示例

```
	{"code":"0","message":"OK","data":"1"}
``` 

##### 值说明

* data:0表示未绑定，1表示已绑定
-----------------------------------------------------------------------------------------------------

### 7、微信JSSDK 

#### 接口名

https://bi.arvatobi.com/mgm/wxconfig?url=www.baidu.com

##### 参数

* url: 必须

#### 返回值

##### 示例

```
	{"code":0,"message":"OK","config":{"timestamp":"1535964010","signature":"fa534af67011bb7ec7a606eaba59728ba07684c0","debug":false,"appId":"wx16b6fbe230aee848","nonceStr":"058E9C56C08AA0581C0B863194D24BD4"}}
``` 

##### 值说明

* config: sdk json对象
-----------------------------------------------------------------------------------------------------

### 8、发送短信验证码

#### 接口名

https://bi.arvatobi.com/mgm/SendVerifyCode?mobile=139

##### 参数

* mobile: 必须

#### 返回值

##### 示例

```
	{"code":4001,"message":"手机号码不能为空"}
	{"code":5000,"message":"发送验证码失败，请稍后再试"}
	{"code":2000,"message":"发送验证码成功，请耐心等待"}

``` 

##### 值说明

* message: 2000成功
-----------------------------------------------------------------------------------------------------

### 9、会员绑定

#### 接口名

https://bi.arvatobi.com/mgm/Bind?mobile=123&code=123

##### 参数

* mobile: 必须
* code: 必须

#### 返回值

##### 示例

```
	{"code":4001,"message":"手机号码不正确"}
	{"code":5001,"message":"请输入验证码"}
	{"code":5003,"message":"请输入正确的验证码"}
	{"code":2000,"message":"绑定成功","membercode":"123"}

``` 

##### 值说明

* message: 2000成功
-----------------------------------------------------------------------------------------------------

### 10、用户领取香氛锦囊判定接口

#### 接口名

g$mgm_user_bag_qualify

##### 参数

* openId: 必须
* shareopenId: 必须

#### 返回值

##### 示例

```
	{"code":"0","message":"OK","data":"[{\"code\":0,\"msg\":\"锦囊未领！\"}]"}
	{"code":"0","message":"OK","data":"[{\"code\":1,\"msg\":\"对不起，您已领取过锦囊！\"}]"}
	{"code":"0","message":"OK","data":"[{\"code\":-1,\"msg\":\"来晚了，这个锦囊已被领走！\"}]"}

``` 

##### 值说明

* data.code:0表示领取成功，其余表示领取失败
-----------------------------------------------------------------------------------------------------

### 11、锦囊类礼品领取接口 --H5活动入口 Step 5 新客领取锦囊

#### 接口名

i$mgm_bag_apply

##### 参数

* openid: 必须，领取人微信号，传空即可，后台从cookie里获取
* shareopenid: 必须，分享人微信号，从url中获取，需解密

#### 返回值

##### 示例

```
	{"code":"0","message":"OK","data":"[{\"code\":0,\"msg\":\"领取成功！\"}]"}
	{"code":"0","message":"OK","data":"[{\"code\":1,\"msg\":\"对不起，您已领取过锦囊！\"}]"}
	{"code":"0","message":"OK","data":"[{\"code\":-1,\"msg\":\"来晚了，这个锦囊已被领走！\"}]"}
``` 

##### 值说明

* data.code:0表示领取成功，其余表示领取失败
-----------------------------------------------------------------------------------------------------

### 12、新客分享锦囊游戏结果保存接口 

#### 接口名

i$mgm_bag_game

#### 参数

* openid: 必须，传空即可，后台从cookie里获取
* bagid: 必须，性格标签，见下表id
		id	name
		1	黑暗骑士
		2	气场女王
		3	阳光宅男
		4	空灵少女
		5	摩登达人
		6	俏皮萝莉
		7	职场巨匠

#### 返回值

##### 示例

```
	{"code":"0","message":"OK","data":"[{\"succ\":1}]"}
``` 

##### 值说明

* succ:0表示制作失败，1制作成功